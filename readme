1.基本认证中间件basicAuth在express4中不存在，
将https://github.com/expressjs/basic-auth-connect/blob/master/index.js的代码保存到node_modules目录下使用。

2. 将用户密码加密
使用 middleware/pass，涉及 register.js 和 login.js
数据库中存放的password仅用于查看，可以不使用该字段；salt和hash即可完成对密码的验证。

3. 设置环境运行
set NODE_ENV=development
set PORT= 6666
supervisor bin/www

4. js函数库
npm install underscore --save

5. ejs include
todo：修改ejs引擎使用html后缀文件后，include的文件后缀必须是ejs

6. 验证码
npm install ccap相当麻烦，采用了直接拷贝的方式；
网上下载的ccap（cmd下执行 npm docs ccap访问）不带async模块，需要将async拷贝到ccap的node_modules下。
todo：引入验证码，即require('ccap')后，supervisor 会不断crash，node bin/www 正常。

7. req.session.checkcode
页面初始加载时，执行了checkcode的get路由，但在登陆时，req.session.checkcode为undefined。
在点击验证码，重新加载后，登陆时，req.session.checkcode为正确的值。

8. 模板中的layout是什么
依赖ejs-mate模块
view/layout下存放母页面

9.  笛风头部尾部渲染交互机制

10. 笛风机票首页渲染交互机制

其他衍生问题：
1. express.static 返回中间件
app.use('/static/cruise/plan', express.static('../../data/plan'));

2. favicon在tab页显示（不是地址栏）
var favicon = require('serve-favicon');
app.use(favicon(__dirname + '/../../public/img/favicon.ico'));

3. todo 解决什么问题
//模板替换无用字符串 start
var reg = /<script.*?>(?:[\s\S]*?)<\/script>|<input(?:[\s\S]*?)>|undefined|NaN|null/mg;
function replaceHtml(html) {
    return html.replace(reg, function (str) {
        if(str.match(/<\/script>/) || str.match(/<input/)){
            return str;
        } else if(str === 'NaN'){
            return 0;
        } else {
            return '';
        }

    });
}
//end
app.engine('html', function (path, data, fn) {
    ejs.apply(this, [path, data, function (err, html) {
        fn.apply(this, [err, replaceHtml(html)]);
    }]);
});

5. app.locals
app.locals._layoutFile = './layouts/main.html';

6. 路由位置
D:\Work\MNTOUR\branch\modules\web\routes\routes.js

7. 移动设备访问www.dfyoo.com，会跳转到下载页面。

8. memcache 全局变量
D:\Work\MNTOUR\branch\common\lib\base.js中封装了一层。  偏函数。 get方法感觉没必要去封装

9. todo res.setHeader('Cache-Control', 'no-cache');

10. todo 什么时候设置账号的状态，即调用toSetAccountStatus

11. todo req.session.modifypwd == "distribute"
distribute ？

12. todo
loginRedirectUrl 这个cookie有什么用

14. 首页的楼层对应的前端模板id：cardTmpl

15. 分销、代理用户区别
/user/loginConfirm

16. 在服务端把字符串写到文件中

17. todo webpack打包解决什么问题
img.tuniucdn.com/df/f/20133333/....  修改js文件后怎么在本地生效（文件相对机票来说较少）

18.  url链接合并  （注释掉app.js中的 process.env.NODE_ENV = "production";）
两个文件、CDN，能打开：http://img1.tuniucdn.com/df/f/20160526001/dist/js/modules/distribute/product/detail.bundle.js,/dist/js/modules/distribute/product/detail.js
两个文件、本地域名，无法打开：http://yaoyin.dfyoo.com:3001/dist/js/modules/distribute/product/detail.bundle.js,/dist/js/modules/distribute/product/detail.js
一个文件、本地域名，能打开：http://yaoyin.dfyoo.com:3001/dist/js/modules/distribute/product/detail.bundle.js

19. npm方式启动

20. nodejs发起请求

21. 前端使用ejs模板

22. 增加链接  http://127.0.0.1:3000/channel/list

23. todo session与memcache关联后，req.session.xxx = yyy后，查看memcache，没有找到xxx。

connect-memcached（用在session里了）与 memcached（用set和get方法了） 的区别

经实践：app.js中session的store不使用memcache时（默认在内存中），用户登陆后，当node进程重启后，登陆状态丢失。使用memcache时，node重启后，登陆状态仍有。
todo 怎么看memcache中保存的session呢    stats、get等方法貌似不行。

24. 引入echarts

25. todo
我觉得我们程序首先功能应该是独立的，就是一个功能出异常了，不应该去影响另外一个正常的功能，不应该将整个程序都崩溃掉，
其次，即使是程序崩溃了，我们也应该有一个让程序自动启动，
另外，应该去记录日志，方便我们跟踪问题。 //ko

26. 引入日志管理

//问题
memcache的清除策略
supervisor 命令行参数
看 ejs 文档
node与java交互
项目结构文档
